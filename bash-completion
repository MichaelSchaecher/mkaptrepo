# shellcheck disable=SC2148
_mkaptrepo_complete () {

    local cur prev commands
    cur="${COMP_WORDS[COMP_CWORD]}"

    # shellcheck disable=SC2034
    prev="${COMP_WORDS[COMP_CWORD-1]}"

    # Main commands
    commands="monitor daemonize create config help version"
    create_opt="--arch -a --codename -c --deb-release -d"

    mapfile -t COMPREPLY < <(compgen -W "${commands}" -- "${cur}")
    case "${COMP_WORDS[1]}" in
        start|stop|restart|status|help|version) ;;
        config)
            mapfile -t COMPREPLY < <(compgen -W "${create_opt}" -- "${cur}")
        ;;
        *)
            # Default to completing the main commands
            if [[ "$COMP_CWORD" -eq 1 ]]; then
                mapfile -t COMPREPLY < <(compgen -W "${commands}" -- "$cur")
            fi
        ;;
    esac
}

# Register the completion function for ddnsd
complete -F _mkaptrepo_complete mkaptrepo
